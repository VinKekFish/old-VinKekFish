# Машина сумасшедшего профессора (машина Виноградова)
"Машина сумасшедшего профессора" умеет решать любые уравнения с числами, длиной не более чем n-битов.
Требуется только лишь память на вход и на выход. n битов памяти означает, что она вводит в себя не более 2^n блоков информации и выводит из себя не более 2^n блоков информации (блок информации не более, чем n битов).
Из блока данных для некоторой n-битной функции "машина сумасшедшего профессора" всегда распознаёт этот блок за n-битную сложность (как один блок этого алгоритма). Для заданной стойкости n*k битов: n-битная функция может выдать не более ⎣n/k⎦ битов за блок (округление вниз).

Комментарий:
Для DES машина будет принимать на вход только 56 битный неизвестный ключ и вычислять 64 битные блоки. То есть стойкость алгоритма здесь меньше, чем битность машины.
Также машина может решить систему из n однобитных уравнений, где уравнения уже невозможно разделить на независимые части (или нехочется их делить).


## Пример AES+AES
Например, уравнение AES(k1, ctr1) + AES(k2, ctr1) + b1 = c1
ctr1 - известен (это счётчик)
b1 - известен, это открытый текст (атака с заданным текстом)
с1 - известен, это блок шифротекста
k1, k2 - неизвестны, блоки ключей
Приходим к уравнению F1(k1) + F2(k2) = c1
128+128 бит неизвестных. c1 - 128 битов известной информации.
Из них "машина сумасшедшего профессора" за один такт способна извлечь 128 битов (2^128) пар (k1, k2).
Следовательно, ей нужно 129 битов памяти (1 бит на хранение пары блоков и 128 битов на хранение 2^128 пар).
Далее, она вносит эти пары во второе уравнение F3(k1) + F4(k2) = c2 (взятое со второго блока шифрования).
Здесь из 128-ми битов неопределённости машина получает полную определённость, так как c2 вносит именно 128-мь битов определённости.
Следовательно, "машина сумасшедшего профессора" рассмотренный алгоритм решает за 129 битов сложности и 2 такта.


## Пример: две функции дают третьей прикурить
Две функции хеширования дают значения на вход третьей функции хеширования. Каждая функция инициализированна ключом полной длины с разными (но известными противнику) синхропосылками.
На каждом такте функция хеширует сама себя и даёт на выход своё значение.
c1 = Hash0(k | Hash1(k) | Hash2(k)) (| - конкатенация)
c2 = Hash0( k | Hash0(k | Hash1(k) | Hash2(k)), Hash1(k | Hash1(k)), Hash2(k | Hash2(k))  )

Числа k по 1024 бита. Блок хеширования по 512-ть битов. Блок на выходе обрезается до 256-ти битов.

Начинаем решать первое уравнение.
256-ть битов на входе. k одно и то же: 1024 бита. То есть неизвестны 1024 бита.
Берём 512-ти битную машину.
Из-за того, что мы не можем работать с числами по 1024 бита, нам придётся работать с хешами.

k11 = Hash1(k); k21 = Hash2(k)
k01 = Hash0(k) (берём упрощение, что можно записать так, как будет ниже записано)
c1 = Hash0(k01 | k11 | k21)

Получаем три числа по 512 битов. Всего 1536 битов. Это то, что нам неизвестно.
То, что нам известно: с1 - 256 битов.
Неопределённость будет 1536−256=1280.
В данном случае мы не имеем парадокса дней рождения, так что учтём все эти 1280 битов.
Это означает, что наша машина уже должна быть 1280 битной.

Следующая машина, которая может работать сразу с ключом k, будет с памятью 1024 бита.
То есть стойкость 1024 бита при первичном рассмотрении обеспечена.


## Пример: 3DES

c1 = DES(k1, DES(k2, DES(k3, ctr)))

ctr - известен (счётчик).
с1 - 64 бита.
ключи k1, k2, k3 по 56-ть битов.

Неопределённость первого уравнения (если есть только один блок) 56*3=168 битов.
c1 - 64 бита определённости.
168-64=104

Получаем 104 бита неопределённости как стойкость алгоритма (в реальности атака встречи по середине даёт большую стойкость - 112 битов).
