# Комбинированная модель допущений и нарушителя

0 - основная
1 - дополнительная (частичное парирование угроз)
2 - учёт с необязательными парированием или затруднением реализации угроз

# Допущения
## Криптография и надёжность ПО
М0. (буквы М - русские)
Я способен в одиночку, без знаний криптографии создать надёжное ПО для криптографии.
Я способен в одиночку, без применения формальных методов и математики, создать надёжное ПО для криптографии.
Keccak и ThreeFish работают как заявлено. Можно использовать только полнораундовые шифры.
Keccak и ThreeFish прозрачны и переносят любые издевательства (можно использовать как абсолютно стойкие шифры без учёта их реальных особенностей). Модель криптографической губки работает.

Злоумышленник способен расшифровывать 512-битные и 1024-битные ключи
Злоумышленник способен обращать хеш keccak полным перебором вариантов, не имея обратной функции.

М1. Злоумышленники спокойно строят предвычисленные таблицы для указанных размеров ключей (1024 бита).
М2. Злоумышленник способен обращать хеш keccak как обратимую функцию, имея 64 байта на выходе и 64 неизвестных байта на входе. Либо, более слабое допущение, обращение идёт для 64\*n байтов на входе и 64\*n+64 байтов на выходе.

### Согласование ключей
Любые алгоритмы удалённого согласования ключей ненадёжны. Ключи согласуются курьерским способом.
Асимметричные алгоритмы не реализуются: используются те, что уже реализованы в других продуктах, если это нужно агенту.
При согласовании ключей могут быть также использованы одноразовые записки в интернете.

# Операции
М0. Агент шифрования шифрует файлы.
1. Хранит их на жёстком диске
2. Хранит их в общедоступном месте
3. Передаёт их по общедоступной сети (сообщения). Сообщения передаются полностью вручную (криптография осуществляется только по ручному запросу пользователя).


# Цели противника агента шифрования
(не все цели парируются)

W.1.1.0. Идентификация агентов шифрования, их количества, отличение их друг от друга, доказывание принадлежности шифротекстов агентам, доказывание связи агентов друг с другом.

W.1.1.1. Агент шифрования зашифровал открытый текст T1 в шифротекст C1. Противник, имея T1 и C1, вынуждает агента шифрования зашифровать T1 тем же ключом, получив шифротекст C2. Противник хочет установить хотя бы с низкой достоверностью (20%), что C2 и C1 зашифровано тем же ключом (или тем же агентом шифрования; на том же компьютере; тем же способом шифрования).

W.1.1.2. Агент шифрования зашифровал открытый T1 в шифротекст C1. Противник, имея T1 и C1, хочет установить с достоверностью М0 95% / М1 50%/ М2 2^-32 , что в C1 действительно зашифрован T1 или зашифрован текст, имеющий ту же самую длину, тот же самый хеш или другие редко совпадающие параметры.

W.1.1.3. Противник имеет набор шифротекстов, необходимо отличить, какие из них зашифрованы одним агентом шифрования (на одном ключе, с одними и теми же особенностями шифрования; тем же способом шифрования) или, наоборот, на разных ключах.

W.1.1.4. Противник имеет набор шифротекстов, необходимо узнать количество агентов, которые их шифровали (или количество ключей шифрования, которыми они зашифрованы).

W.1.1.5. По набору зашифрованных ключевых файлов двух агентов невозможно установить, имеются ли у этих агентов одинаковые ключи (и вообще, знакомы ли агенты друг с другом).

W.1.1.6. Противник имеет набор шифротекстов и ключ шифрования. Необходимо доказать подлинность переписки, когда шифротексты или открытые тексты найдутся у других агентов шифрования (взлом переписки с утёкшим ключом).
Непонятно, как от этого защититься (только уничтожением или перешифрованием текстов; то есть нельзя хранить отосланные тексты с тем же ключом, который известен другому агенту).
В целом, т.к. шифрование симметричное, это не так важно, ведь как только секретный ключ опубликован, то кто угодно может подписать что угодно (в том числе, противник может подделать любые шифротексты).

W.1.2.0. Подмена текста, в т.ч. отсылка своего текста под видом текста от другого агента

W.1.2.1. Подмена текста с помощью пыток или другого вынуждения агента, отсылающего текст.

W.1.3.0. Расшифровка текста либо установление его значимых свойств (на коротких текстах, отличение "да" от "нет", установление точной длины текста, установления типа открытого файла, установление границ внутренних секций открытого файла)

W.1.3.1. Установление даты создания открытого файла или шифротекста, порядка шифровки относительно других файлов

W.1.3.2. Отличение зашифрованного шума от зашифрованных данных (в том числе, при наличии исходных данных).

W.1.3.3. Отличение зашифрованной закономерной последовательности от зашифрованных данных.

W.1.3.4. Имеется открытый текст T. Есть шифротексты C1, C2, ... Cn. Все они - зашифрованный текст T на одном и том же ключе в одном и том же режиме шифрования. Злоумышленнику известно всё, кроме T. Необходим  найти T. Значение n ограничено возможностями и/или потребностью агента зашифровать T многократно (автоматическое шифрование при резервном копировании, например).

W.1.3.5. Расшифровка текста после установления его ключа. Текст должен быть как можно проще удаляем (он должен содержать шум, который дополнительно затруднит расшифрование блоков, если хотя бы один из них удалён или повреждён)

W.1.4.0. Вмешательство в код криптографического приложения с целью внедрения уязвимостей. В том числе, подмена цепочек поставок, давление или уничтожение основного разработчика или приравненных к нему лиц (способных осуществить нужную степень вмешательства).

W.1.5.0. Установление ключей шифрования по известным парам открытый текст/шифротекст или иным способом (для любых дальнейших применений)

W.1.5.1. Установление по одному одноразовому ключу другого ключа или мастер-ключа.

W.1.6.0. Интимные угрозы (угрозы со стороны близкого лица, в том числе, гиперконтролирующего)

W.1.6.1. Физический захват устройства, уничтожение либо доступ к устройству (внутри семьи или от третьих лиц с использованием членов семьи, в т.ч. детей)
W.1.6.2. Уничтожение ключей или присвоение носителя информации с ключами (в том числе, в результате ошибки: перепутал флешку)
W.1.6.3. Передача устройства другой стороне или временный доступ к устройству (например, ремонт устройства, обслуживание)

W.1.7.0. Захват пароля, ключа или расшифрованной информации
W.1.7.1. Подсматривание пароля при вводе (пароль должен вводится так, чтобы даже близкий человек не мог специально или случайно запомнить пароль)
W.1.7.2. Выявление пароля пытками
W.1.7.3. Выявление пароля под страхом наказания (скрытность шифрования при наблюдении - идеал, но невозможный)
W.1.7.4. Работа через ПЭМИН, в том числе, чтение клавиатуры, экрана или даже процессорной шины
W.1.7.5. Захват пароля скрытно (например, spyware, установленное любовником) или явно и расшифровка дальнейших сообщений, зашифрованных этим паролем.
W.1.7.6. Возможность доказать при получении пароля/ключа от одной стороны, что другая сторона имеет соотв. зашифрованный файл или пароль/ключ. В том числе, принуждение к открытию пароля и расшифровке сообщений постфактум (нужно что-то, что не позволит расшифровать сообщения даже под пытками, если они зашифрованы по этой технологии и уже удалены).

# Случайные проблемы

PP0.1.0. Использование для зашифрования скомпрометированного ключа
PP0.1.1. Использование для зашифрования ключа, который известен или может быть известен лицу, для которого данный открытый текст не предназначен
PP0.2.0. Недоступность ключа шифрования.
PP0.2.1. Забытый пароль от ключа шифрования
PP0.3.0. Утеря ключа шифрования (его возможная доступность третьим лицам).
PP0.3.1. Утеря носителя с незашифрованным ключом шифрования (зашифрованным, но пароль злоумышленнику может быть известен).
PP0.3.2. Использование ключа шифрования на недоверенном компьютере (с возможной утерей)
PP0.3.3. Нужно сменить пароль, но это очень тяжело, т.к. нужно много всего перешифровывать. Ключ не скомпрометирован и может быть использован с новым паролем.
PP0.4.0. Небрежность пользователя: зашифровал плохим паролем, другой программой и т.п.


# Возможности противника

## Доступ к устройству
М0. Нет доступа к устройству, на котором происходит шифрование. Доступ возможен только после выключения компьютера (в том числе, после его повторного включения без проведения процедур шифрования данным ПО). Доступ возможен многократный.
Шифрованные жёсткие диски расшифрованы, любые иные системы шифрования сломаны.
Все зашифрованные файлы известны противнику (если иное прямо не следует из рассматриваемого случая).
В компьютере нет закладок.

М1. После завершения всех процедур шифрования противник способен захватить компьютер во включённом состоянии, обеспечив себе полный доступ. Файлы подкачки (разделы) отключены пользователем, расшифрованные на логические диски в памяти файлы пользователем перезатёрты.

М2. При шифровании противник имеет кейлоггер на компьютере. Возможно, допустимы и другие средства наблюдения.


## Интерактивные атаки и тайминг-атаки
Под интерактивной (автоматически интерактивной) понимается атака, при которой компьютер агента без его участия может произвести процедуру, требующую ключей шифрования или обработки открытого текста или других конфиденциальных данных.
Вариант 1. Компьютер получает приказ на обработку информации от противника.
Вариант 2. Компьютер получает приказ на обработку информации от агента. Но противник может продлевать обработку информации, менять её содержимое и т.п.

М0. Автоматические интерактивные атаки невозможны.
При атаке на агента, агент осуществляет все криптографические операции вручную. То есть противник, пославший нечто агенту или вынудивший агента совершить операцию, получает криптографическую операцию, активированную вручную.

М1. Интерактивные атаки возможны, тайминг атаки на интерактивных атаках считаются парированными, если нет явной зависимости между конфиденциальной информацией, ключевой информацией или информацией, которая генерируется из ключей, и:
1. Последовательностью команд (она одна и та же вне зависимости от данных, исключая повторы для обработки блоков в зависимости от объёма открытого текста и длины ключа)
2. Последовательностью доступа к адресам в памяти (в том числе, кеш-памяти)
3. Задержками, объёмом данных (исключая задержки, обусловленные объёмом открытого текста, длиной ключа, режимом шифрования)

М2. Возможны тайминг-атаки любых типов.

## Атаки с заданным текстом и перехват данных
М0. Возможны неинтерактивные атаки с заданным текстом. Заданный текст может быть зашифрован неоднократно вручную или для резервного копирования (возможно, вместе с другими данными, например, в архиве или как цитата).

М1. Возможны автоматические интерактивные атаки с заданным текстом в любом количестве, доступном атакуемому агенту шифрования на его мощностях.

М0. Противнику известны все открытые тексты в паре с шифротекстами (он хочет установить ключ шифрования для осуществления подлога либо расшифровки дальнейших текстов).

М1. Противник может шифровать выбранные им открытые тексты сколько угодно раз. Ограничено только возможностями оборудования атакуемого агента.
То есть противник может отдавать приказы шифровать всё, что ему угодно, на неизвестном ему ключе.


## Атаки по электрическим цепям и радиоканалам
М0. Невозможны
М1. ПЭМИН, атаки на наводки, в том числе, тайминг атаки с заданным текстом. Невозможно по алгоритму keccak узнать ключ шифрования. Невозможно по алгоритму Threefish узнать ключ шифрования, если на одном ключе зашифровано менее или ровно 12 блоков (1024 битов ключа на 80 раундов - это просто с потолка значение).
Невозможно по элементарным операциям или keccak и Threefish в системе узнать ключ, если он обрабатывается непостоянно (в губке или дуплексе с преобразованием на первом шаге с уникальным открытым вектором инициализации либо кратковременно; вектор должен обрабатываться первым, чтобы рандомизировать состояние губки до преобразования ключа).

## Пытки, хищения и т.п.
М0. Ключи и проч. информация управляется без ошибок, разумно и верно.
Агент противостоит пыткам.
Пароли могут быть разделены на части. Если используются несколько ключей для шифрования одного сообщения или другого ключа, все ключи, кроме одного, могут быть известны злоумышленнику. Аналогично для частей пароля.

М1. Агента могут пытать или другим образом вынуждать к отсылке неверной информации, расшифровке или чему-то ещё. Само шифрование разрешено, но могут наказать за отказ за "сотрудничество".

М2. Противник точно знает, что эта информация у агента есть, даже если она скрыта в шуме в ином файле и может вынудить агента её раскрыть.
Противник может быть не слишком предусмотрительным, то есть частичная защита тоже допустима.

## Воздействия на ключ
M0. Ключ может быть частично под контролем противника либо случайно обнулён. Оставшаяся энтропия должна быть эффективно использована для шифрования.

# Модель супермена
MS1.1. Супермен может принудить человека сделать что-либо, просто посмотрев на него (лично)
MS2.1. Супермен может дать приказ забыть всё

MS0.2. Супермен может принудить человека сделать что-либо, но только штатного не владельца ключа/пароля, пока он на него смотрит
MS1.2. Это же, но приказ будет действовать даже после того, как контакт взглядом потерян. (Реальная модель: злоумышленник посылает некоторому мужчине сообщение от имени женщины со словами "иди, изнасилуй меня" и её реальным адресом)
MS1.3. Это же, но на одного из владельцев ключа/пароля (если их несколько) либо временно на всех

MS0.4. "Машина сумасшедшего профессора" умеет решать любые уравнения с числами, длиной не более чем n-битов.
Требуется только лишь память на вход и на выход. n битов памяти означает, что она вводит в себя не более 2^n блоков информации и выводит из себя не более 2^n блоков информации (блок информации не более, чем n битов).

Например, уравнение AES(k1, ctr1) + AES(k2, ctr1) + b1 = c1
ctr1 - известен (это счётчик)
b1 - известен, это открытый текст (атака с заданным текстом)
с1 - известен, это блок шифротекста
k1, k2 - неизвестны, блоки ключей
Приходим к уравнению F1(k1) + F2(k2) = c1
128+128 бит неизвестных. c1 - 128 битов известной информации.
Из них "машина сумасшедшего профессора" за один такт способна извлечь 128 битов (2^128) пар (k1, k2).
Следовательно, ей нужно 129 битов памяти (1 бит на хранение пары блоков и 128 битов на хранение 2^128 пар).
Далее, она вносит эти пары во второе уравнение F3(k1) + F4(k2) = c2 (взятое со второго блока шифрования).
Здесь из 128-ми битов неопределённости машина получает полную определённость, так как c2 вносит именно 128-мь битов определённости.
Следовательно, "машина сумасшедшего профессора" рассмотренный алгоритм решает за 129 битов сложности и 2 такта.

MS0.5. Из блока данных для некоторой n-битной функции "машина сумасшедшего профессора" всегда распознаёт этот блок за n-битную сложность. Для заданной стойкости n*k битов: n-битная функция может выдать не более ⎣n/k⎦ битов за блок (округление вниз).


